<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="IpcCollectionMapper">
	<!-- 根据id查找收藏的方案列表 -->	<select id="getPlanlistPage" parameterType="pd" resultType="hashmap">		SELECT			WT.ID id,			WT.CONTENT_TITLE title,			WT.CONTENT_SUMMARY summary,			WCC.COLUMNID columnId,			DATE_FORMAT(WC.create_time,'%Y-%m-%d %H:%i') AS createTime		FROM			WEB_COLLECTION WC		LEFT JOIN WEB_CONTENT WT ON WC.source_id=WT.ID 		LEFT JOIN WEB_CONTENT_COLUM WCC ON WT.ID=WCC.CONTENTID				WHERE			WC.user_id=#{pd.userId}	and WC.source_type=1			ORDER BY			WC.create_time DESC	</select>		<!-- 根据id查找收藏的方案列表 -->	<select id="getTopiclistPage" parameterType="pd" resultType="hashmap">		SELECT			WT.id,			WT.title,			WT.detail,			WT.user_id userId,			DATE_FORMAT(WC.create_time,'%Y-%m-%d %H:%i') AS createTime		FROM			WEB_COLLECTION WC		LEFT JOIN WEB_TOPIC WT ON WC.source_id=WT.id 				WHERE			WC.user_id=#{pd.userId}	and WC.source_type=2			ORDER BY			WC.create_time DESC	</select>		<!-- 收藏方案或话题 -->	<insert id="saveCollection" parameterType="pd">		insert into			WEB_COLLECTION			(id,user_id,source_id,source_type)		values			(#{id},#{userId},#{sourceId},#{sourceType})	</insert>		<!-- 查找是否已收藏  -->	<select id="findBySourceIdAndSourcetypeAndUserId" parameterType="pd" resultType="int">		SELECT 			count(*)		FROM			WEB_COLLECTION		WHERE			user_id=#{userId} and source_id=#{sourceId} and source_type=#{sourceType}	</select>		<!-- 取消收藏 -->	<delete id="cancelCollection" parameterType="pd">		DELETE			from 		WEB_COLLECTION		WHERE			user_id=#{userId} and source_id=#{sourceId} and source_type=#{sourceType}		</delete></mapper>