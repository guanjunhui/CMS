<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="ServiceNetworkMapper">
	<!-- 开始 -->
	<resultMap id="ServiceNetworkResultMap" type="cn.cebest.entity.system.ServiceNetwork.ServiceNetwork">
		<id column="ID" jdbcType="VARCHAR" property="id" />
		<result column="NAME" jdbcType="VARCHAR" property="name" />
		<result column="ADDRESS" jdbcType="VARCHAR" property="address" />
		<result column="CONTACT" jdbcType="VARCHAR" property="contact" />
		<result column="PHONE" jdbcType="VARCHAR" property="phone" />
		<result column="EMAIL" jdbcType="VARCHAR" property="email" />
		<result column="CHARA_CTER" jdbcType="VARCHAR" property="character" />
		<result column="CONTINENTID" jdbcType="VARCHAR" property="continentId" />
		<result column="COUNTRYID" jdbcType="VARCHAR" property="countryId" />
		<result column="CHARACTERID" jdbcType="VARCHAR" property="characterId" />
		<result column="SITEID" jdbcType="VARCHAR" property="siteId" />
		<result column="CREATED_TIME" jdbcType="TIMESTAMP" property="createdTime" />
		<result column="UPDATE_TIME" jdbcType="TIMESTAMP" property="updateTime" />
		<result column="RELEASE_TIME" jdbcType="TIMESTAMP" property="releaseTime" />
		<result column="CHARACTER_CN" jdbcType="VARCHAR" property="characterCN" />
		<result column="CHARACTER_EN" jdbcType="VARCHAR" property="characterEN" />
		<result column="CONTINENT_CN" jdbcType="VARCHAR" property="continentCN" />
		<result column="CONTINENT_EN" jdbcType="VARCHAR" property="continentEN" />
		<result column="COUNTRY_CN" jdbcType="VARCHAR" property="countryCN" />
		<result column="COUNTRY_EN" jdbcType="VARCHAR" property="countryEN" />
		<result column="PRODUCTCOUNT" jdbcType="VARCHAR" property="productCount" />
		<result column="PRODUCTID" jdbcType="VARCHAR" property="productId" />
		<result column="PRODUCTNAME" jdbcType="VARCHAR" property="productName" />
		<result column="IMGURL" jdbcType="VARCHAR" property="imageUrl" />
		<result column="TOPPERCENT" jdbcType="VARCHAR" property="topPercent" />
		<result column="LEFTPERCENT" jdbcType="VARCHAR" property="leftPercent" />
		<result column="SERVICENATURENAME" jdbcType="VARCHAR" property="serviceNatureName" />
		<result column="LONGITUDE" jdbcType="VARCHAR" property="longitude" />
		<result column="LATITUDE" jdbcType="VARCHAR" property="latitude" />
		
		<result column="SERVICENATUREBIANMA" jdbcType="VARCHAR" property="serviceNatureCode" />
	</resultMap>
	
	<!-- 前台查询服务商 -->
	<select id="selectServiceFrontlistPage" parameterType="page" resultMap="ServiceNetworkResultMap">
		SELECT
			SN.ID, SN.NAME, SN.SITEID, SN.CONTINENTID, SN.COUNTRYID, 
			SN.ADDRESS, SN.CONTACT, SN.PHONE, SN.EMAIL, SN.CREATED_TIME,
			SN.LONGITUDE, SN.LATITUDE,
			D1.BIANMA AS SERVICENATUREBIANMA
		FROM WEB_SERVICENETWORK SN
		LEFT JOIN SYS_DICTIONARIES D1 ON SN.SERVICENATUREID = D1.DICTIONARIES_ID
		<where>
			1=1
			<if test="pd.continentId !=null and pd.continentId != ''">
				AND SN.CONTINENTID=#{pd.continentId}
			</if>
		</where>
	</select>
	
	<!-- 前端搜索经销商服务网点 -->
	<select id="selectNetworkByName" parameterType="pd" resultMap="ServiceNetworkResultMap">
		SELECT
			SN.ID, SN.NAME, SN.SITEID, SN.CONTINENTID, SN.COUNTRYEN, 
			SN.ADDRESS, SN.CONTACT, SN.PHONE, SN.EMAIL, SN.CREATED_TIME,
			SN.LONGITUDE, SN.LATITUDE
		FROM WEB_SERVICENETWORK SN
		<where>
			1=1
			<if test="SITEID !=null and SITEID != ''">
				AND SN.SITEID=#{pd.SITEID}
			</if>
			<if test=" result !=null and result != ''">
				AND SN.NAME LIKE '%' #{result} '%'
				OR SN.COUNTRYEN LIKE '%' #{result} '%'
				OR SN.ADDRESS LIKE '%' #{result} '%'
			</if>
		</where>
	</select>
	
	<!-- cms后台服务网点显示列表 -->
	<select id="selectServiceNetworklistPage" parameterType="page" resultMap="ServiceNetworkResultMap">
		SELECT 
			A.ID,A.NAME,A.CONTINENTID, A.COUNTRYEN AS COUNTRY_EN,A.ADDRESS,A.CONTACT,A.PHONE,A.EMAIL,
			A.SITEID,A.CREATED_TIME,A.UPDATE_TIME, A.RELEASE_TIME
		FROM WEB_SERVICENETWORK A 
		<where>
			1=1
			<if test="pd.SITEID !=null and pd.SITEID != ''">
				AND A.SITEID=#{pd.SITEID}
			</if>
			<if test="pd.keywords !=null and pd.keywords != ''">
				AND A.NAME LIKE '%' #{pd.keywords} '%'
			</if>
		</where>
		<!-- <if test="pd.CREATED_TIME !=null and pd.CREATED_TIME !=''"> -->
			ORDER BY A.CREATED_TIME DESC
		<!-- </if> -->
	</select>
	
	<!-- 查询大洲 -->
	<select id="selectContinent" resultMap="ServiceNetworkResultMap">
		SELECT
			D2.DICTIONARIES_ID AS CONTINENTID, D2.NAME_EN AS CONTINENT_EN ,D2.ORDER_BY
		FROM SYS_DICTIONARIES D1
		LEFT JOIN SYS_DICTIONARIES D2 ON D1.DICTIONARIES_ID = D2.PARENT_ID
		WHERE D1.BIANMA = 'T001'  ORDER BY D2.ORDER_BY
	</select>
	<!-- 根据大洲查询国家 -->
	<select id="selectCountry" parameterType="cn.cebest.entity.system.ServiceNetwork.Agency" resultMap="ServiceNetworkResultMap">
		SELECT
			D2.DICTIONARIES_ID AS CONTINENTID, D2.NAME_EN AS CONTINENT_EN ,D2.ORDER_BY
		FROM SYS_DICTIONARIES D1
		LEFT JOIN SYS_DICTIONARIES D2 ON D1.DICTIONARIES_ID = D2.PARENT_ID
		WHERE D1.BIANMA = 'C999'  ORDER BY D2.ORDER_BY
	</select>

	<!-- 保存服务网点信息 -->
	<insert id="saveServiceNetwork" parameterType="cn.cebest.entity.system.ServiceNetwork.ServiceNetwork">
		insert into WEB_SERVICENETWORK
		(ID,NAME,EMAIL,ADDRESS,CONTACT,PHONE,CONTINENTID,COUNTRYEN,SITEID,CREATED_TIME,UPDATE_TIME,RELEASE_TIME,LONGITUDE,LATITUDE)
		values
		(#{id},#{name},#{email},#{address},#{contact},#{phone},#{continentId},#{countryEN},#{siteId},#{createdTime},#{updateTime},#{releaseTime},#{longitude},#{latitude})
	</insert>
	
	<!-- 保存服务网点信息 -->
	<insert id="saveBachServiceNetwork" parameterType="cn.cebest.entity.system.ServiceNetwork.ServiceNetwork">
		insert into WEB_SERVICENETWORK
		(ID,NAME,EMAIL,ADDRESS,CONTACT,PHONE,CONTINENTID,COUNTRYEN,SITEID,CREATED_TIME,UPDATE_TIME,RELEASE_TIME,LONGITUDE,LATITUDE)
		values
		<foreach collection="list" item="network" separator="," open="" close="">
			(#{network.id},#{network.name},#{network.email},#{network.address},#{network.contact},#{network.phone},#{network.continentId},#{network.countryEN},#{network.siteId},#{network.createdTime},#{network.updateTime},#{network.releaseTime},#{network.longitude},#{network.latitude})
		</foreach>
	</insert>
	
	<!-- 根据id查询服务网点信息-->
	<select id="selectServiceNetworkById" parameterType="String" resultMap="ServiceNetworkResultMap">
		SELECT
			A.ID,A.NAME,A.ADDRESS,A.CONTACT,A.PHONE,A.EMAIL, A.CONTINENTID, A.COUNTRYEN,
			A.LONGITUDE, A.LATITUDE
		FROM WEB_SERVICENETWORK A
		WHERE A.ID = #{id}
	</select>
	<!-- 修改代理商 -->							
	<update id="updateServiceNetwork" parameterType="cn.cebest.entity.system.ServiceNetwork.ServiceNetwork">
		UPDATE WEB_SERVICENETWORK
		<set>
			<if test="name !=null and name !=''">NAME=#{name},</if>
			<if test="address !=null and address !=''">ADDRESS=#{address},</if>
			CONTACT=#{contact},
			PHONE=#{phone},
			<if test="email !=null and email !=''">EMAIL=#{email},</if>
			<if test="continentId !=null and continentId !=''">CONTINENTID=#{continentId},</if>
			<if test="countryEN !=null and countryEN !=''">COUNTRYEN=#{countryEN},</if>
			<if test="siteId !=null and siteId !='' ">SITEID=#{siteId},</if>
			<if test="updateTime !=null and updateTime !=''">UPDATE_TIME=#{updateTime},</if>
			<if test="topPercent !=null and topPercent !=''">TOPPERCENT=#{topPercent},</if>
			<if test="leftPercent !=null and leftPercent !=''">LEFTPERCENT=#{leftPercent},</if>
			<if test="longitude !=null and longitude !=''">LONGITUDE=#{longitude},</if>
			<if test="latitude !=null and latitude !=''">LATITUDE=#{latitude},</if>
			
		</set>
		WHERE ID=#{id}
	</update>
	
	<!-- 批量删除代理商 -->
	<delete id="deleteServiceNetworkBatch">
		DELETE FROM WEB_SERVICENETWORK
		WHERE ID IN
		<foreach collection="array" close=")" item="id" open="("
			separator=",">
			#{id}
		</foreach>
	</delete>
	<!-- 保存咨询产品信息 -->
	<!-- <insert id="saveProductConsult" parameterType="cn.cebest.entity.web.ProductConsult">
		insert into WEB_PRODUCT_CONSULT
		(ID,NAME,PHONE,EMAIL,QUESTIONORCOMMIT,COMPANY,CREATED_TIME,PRODUCTID,SITEID)
		values
		(#{id},#{name},#{phone},#{email},#{questionOrCommit},#{company},#{createdTime},#{productId},#{siteId})
	</insert> -->
	<!-- 查询大洲地图 -->
	<!-- <select id="selectContinentMap" parameterType="cn.cebest.entity.system.agency.Agency"  resultMap="ServiceNetworkResultMap">
		SELECT
			D.DICTIONARIES_ID AS CONTINENTID, D.NAME_EN AS CONTINENT_EN,
			I.IMGURL
		FROM SYS_DICTIONARIES D
		LEFT JOIN WEB_IMAGE I ON D.NAME_EN = I.TITLE AND D.BIANMA = I.SUBHEAD
		<where>
			1=1
			<if test="continentId !=null and continentId != ''">
				AND D.DICTIONARIES_ID=#{continentId}
			</if>
		</where>
	</select> -->
	<!-- 结束 -->


	<resultMap id="BaseResultMap" type="cn.cebest.entity.system.ColumConfig">
		<id column="ID" property="id" jdbcType="VARCHAR" />
		<result column="COLUM_NAME" property="columName" jdbcType="VARCHAR" />
		<result column="COLUM_URLPATH" property="columUrlpath"
			jdbcType="VARCHAR" />
		<result column="COLUM_DISPLAY" property="columDisplay"
			jdbcType="VARCHAR" />
		<result column="PARENTID" property="parentid" jdbcType="VARCHAR" />
		<result column="SORT" property="sort" jdbcType="INTEGER" />
		<result column="SITEID" property="siteid" jdbcType="VARCHAR" />
		<result column="COLUM_TEMPLATETID" property="columTemplatetid"
			jdbcType="VARCHAR" />
		<result column="COLUM_SUBNAME" property="columSubname"
			jdbcType="VARCHAR" />
		<result column="COLUM_IMAGE" property="columImage" jdbcType="VARCHAR" />
		<result column="COLUM_DESC" property="columDesc" jdbcType="VARCHAR" />
		<result column="OUT_URL" property="outUrl" jdbcType="VARCHAR" />
		<result column="CREATETIME" jdbcType="TIMESTAMP" property="createtime" />
		<association property="template" resultMap="TemplateMap" />
	</resultMap>

	<resultMap id="TemplateMap" type="cn.cebest.entity.system.Template">
		<id column="TEM_ID" jdbcType="VARCHAR" property="id" />
		<result column="TEM_NAME" jdbcType="VARCHAR" property="temName" />
		<result column="TEM_FILEPATH" jdbcType="VARCHAR" property="temFilepath" />
		<result column="TEM_FILENAME" jdbcType="VARCHAR" property="temFilename" />
		<result column="CREATETIME" jdbcType="TIMESTAMP" property="createtime" />
		<result column="TEM_TYPE" jdbcType="VARCHAR" property="temType" />
		<result column="TEM_IMAGEPATH" jdbcType="VARCHAR" property="temImagepath" />
	</resultMap>

	<resultMap type="cn.cebest.entity.system.content.Content" id="detailAndImgRelevantList">
		<id column="id" property="id" />
		<result column="contentTitle" property="contentTitle" />
		<result column="contentWbUrl" property="contentWbUrl" />
		<result column="contentSummary" property="contentSummary" />
		<result column="contentKeyWords" property="contentKeyWords" />
		<result column="contentStatus" property="contentStatus" />
		<result column="typeId" property="typeId" />
		<result column="typeName" property="typeName" />
		<result column="typeCode" property="typeCode" />
		<result column="source" property="source" />
		<result column="detailTitle" property="detailTitle" />
		<result column="createdTime" property="createdTime" />
		<result column="releaseTime" property="releaseTime" />
		<result column="pv" property="pv" />
		<result column="shareCount" property="shareCount" />
		<result column="contentTxt" property="contentTxt" />
		<result column="columconfigId" property="columconfigId" />
		<result column="contentTemplatetId" property="contentTemplatetId" />
		<collection property="imageList" column="imgId" javaType="ArrayList"
			ofType="cn.cebest.entity.system.Image">
			<id column="imgId" property="imageId" />
			<result column="imgurl" property="imgurl" />
		</collection>
		<collection property="contentRelevantList" column="contentId"
			ofType="cn.cebest.entity.system.content.Content" javaType="ArrayList">
			<id column="contentId" property="id" />
			<result column="contentTitle" property="contentTitle" />
			<result column="contentWbUrl" property="contentWbUrl" />
			<result column="contentSummary" property="contentSummary" />
			<result column="contentKeyWords" property="contentKeyWords" />
			<result column="createdTime" property="createdTime" />
			<result column="contentStatus" property="contentStatus" />
		</collection>
	</resultMap>
	<!-- begin wzd -->
	<resultMap type="cn.cebest.entity.system.content.Content" id="resultContent">
		<id property="id" column="ID" />
		<result property="contentTitle" column="CONTENT_TITLE" />
		<result property="contentWbUrl" column="CONTENT_WBURL" />
		<result property="contentSummary" column="CONTENT_SUMMARY" />
		<result property="contentKeyWords" column="CONTENT_KEYWORDS" />
		<result property="contentStatus" column="CONTENT_STATUS" />
		<result property="source" column="SOURCE" />
		<result property="detailTitle" column="DETAIL_TITLE" />
		<result property="createdTime" column="CREATED_TIME" />
		<result property="releaseTime" column="RELEASE_TIME" />
		<result property="recommend" column="RECOMMEND" />
		<result property="recommend_time" column="RECOMMEND_TIME"/>
		<result property="top" column="TOP" />
		<result property="siteId" column="SITEID" />
		<result property="title" column="TITLE" />
		<result property="pv" column="PV" />
		<result property="shareCount" column="SHARE_COUNT" />
		<result property="contentTxt" column="TXT" />
		<result property="filedJson" column="FILEDJSON" />
		<result column="SURFACE_IMAGEURL" property="surface_imageurl" />
		<result column="IMAGE_ID" property="surface_imageid" />
		<result property="contentTemplateId" column="CONTENT_TEMPLATEID" />
			<result column="AUTHOR" property="author" />
		<collection property="imageList" ofType="cn.cebest.entity.system.Image">
			<id column="image_id_" property="imageId" />
			<result column="type_" property="type" />
			<result column="title_" property="title" />
			<result column="imgurl_" property="imgurl" />
			<result column="bz" property="bz" />
			<result column="tourl_" property="tourl" />
			<result column="SUBHEAD" property="subhead" />
		</collection>
		<collection property="videoList" ofType="cn.cebest.entity.system.Video">
			<id column="video_id_" property="id" />
			<result column="video_type_" property="video_type" />
			<result column="video_title_" property="video_title" />
			<result column="video_url_" property="video_url" />
			<result column="video_content_" property="video_content" />

			<result column="VIDEO_TOURL" property="tourl" />
		</collection>
		<collection property="contentRelevantList"
			ofType="cn.cebest.entity.system.content.Content">
			<id property="id" column="ID_" />
			<result property="contentTitle" column="CONTENT_TITLE_" />
		</collection>
		<collection property="columConfigList" ofType="cn.cebest.entity.system.ColumConfig">
			<id property="id" column="CID_" />
			<result property="columName" column="COLUMN_NAME_" />
		</collection>
	</resultMap>
	<!-- end wzd -->
	<!-- 前台接口,查询内容列表 -->
	<select id="listContentlistPage" resultMap="detailAndImgRelevantList"
		parameterType="page">
		SELECT
		WC.ID AS id,
		WC.TYPEID AS typeId,
		WCT.TYPE_NAME AS typeName,
		WI.IMAGE_ID AS imgId,
		WI.IMGURL AS imageUrl,
		WC.CONTENT_TITLE AS contentTitle,
		WC.CREATED_TIME AS createdTime,
		WC.CONTENT_SUMMARY AS contentSummary,
		WC.CONTENT_KEYWORDS AS contentKeyWords
		FROM
		WEB_CONTENT WC
		LEFT JOIN WEB_CONTENTTYPE WCT ON WC.TYPEID = WCT.ID
		LEFT JOIN
		WEB_CONTENT_IMAGE WCI ON WCI.CONTENT_ID = WC.ID
		LEFT JOIN WEB_IMAGE WI
		ON WCI.IMAGE_ID = WI.IMAGE_ID
		<trim prefix="WHERE" prefixOverrides="AND|OR">
			WC.CONTENT_STATUS = '0'
			<if test="pd.typeId!=null and pd.typeId!=''">
				AND WCT.TYPEID =#{pd.typeId}
			</if>
		</trim>
		ORDER BY WC.CREATED_TIME
	</select>
	<!-- 前台接口,根据内容id查询内容详情和相关内容 -->
	<select id="detailByContentId" resultMap="detailAndImgRelevantList"
		parameterType="page">
		SELECT
		WC.ID AS id,
		WCTY.TYPE_NAME AS typeName,
		WC.SOURCE AS source,
		WC.RELEASE_TIME AS releaseTime,
		WC.PV AS pv,
		WC.SHARE_COUNT AS shareCount,
		WCT.TXT AS contentTxt,
		WI.IMAGE_ID AS imgId,
		WI.IMGURL AS imgUrl,
		WC1.ID AS contentId,
		WC1.CONTENT_TITLE AS contentTitle,
		WC1.CONTENT_WBURL AS contentWbUrl,
		WC1.CONTENT_SUMMARY AS contentSummary,
		WC1.CONTENT_KEYWORDS AS contentKeyWords,
		WC1.CREATED_TIME AS createdTime,
		WC1.CONTENT_STATUS AS contentStatus
		FROM
		WEB_CONTENT WC
		LEFT JOIN WEB_TXT WCT ON WCT.CONTENT_ID = WC.ID
		LEFT JOIN
		WEB_CONTENT_IMAGE WCI ON WCI.CONTENT_ID = WC.ID
		LEFT JOIN WEB_IMAGE WI
		ON WCI.IMAGE_ID = WI.IMAGE_ID
		LEFT JOIN WEB_CONTENTTYPE WCTY ON
		WC.TYPEID = WCTY.ID
		LEFT JOIN WEB_CONTENT_RELEVANT WCR ON
		WCR.CONTENT_ID = WC.ID
		LEFT JOIN WEB_CONTENT WC1 ON WCR.RELEVANT_ID =
		WC1.ID
		AND WC1.CONTENT_STATUS = '0'
		<trim prefix="WHERE" prefixOverrides="AND|OR">
			WC.CONTENT_STATUS = '0'
			<if test="pd.id!=null and pd.id!=''">
				AND WC.ID = #{pd.id}
			</if>
		</trim>
	</select>
	<!-- 后台接口,内容列表 -->
	<select id="contentlistPage" resultMap="detailAndImgRelevantList"
		parameterType="page">
		SELECT
		WC.ID AS id,
		WC.TYPEID AS typeId,
		WCT.TYPE_NAME AS typeName,
		WI.IMAGE_ID AS imgId,
		WI.IMGURL AS imgurl,
		WC.CONTENT_TITLE AS contentTitle,
		WC.CREATED_TIME AS createdTime,
		WC.CONTENT_SUMMARY AS contentSummary,
		WC.CONTENT_KEYWORDS AS contentKeyWords,
		WC.CONTENT_STATUS AS contentStatus,
		WCTT.TXT AS contentTxt
		FROM
		WEB_CONTENT WC
		LEFT JOIN WEB_CONTENTTYPE WCT ON WC.TYPEID = WCT.ID
		LEFT JOIN
		WEB_CONTENT_IMAGE WCI ON WCI.CONTENT_ID = WC.ID
		LEFT JOIN WEB_IMAGE WI
		ON WCI.IMAGE_ID = WI.IMAGE_ID
		LEFT JOIN WEB_TXT WCTT ON WCTT.CONTENT_ID
		= WC.ID
		<trim prefix="WHERE" prefixOverrides="AND|OR">
			<if test="pd.keywords!=null and pd.keywords!=''">
				AND WC.CONTENT_TITLE LIKE CONCAT(CONCAT('%',
				#{pd.keywords}), '%')
			</if>
			<if test="pd.startTime!=null and pd.startTime!=''">
				AND WC.CREATED_TIME &gt;= #{pd.startTime}
			</if>
			<if test="pd.endTime!=null and pd.endTime!=''">
				AND WC.CREATED_TIME &lt;= #{pd.endTime}
			</if>
			<if test="pd.status!=null and pd.status!=''">
				AND WC.CONTENT_STATUS = #{pd.status}
			</if>
		</trim>
		ORDER BY WC.CREATED_TIME
	</select>
	<!-- 更新内容的状态 -->
	<update id="updateContent" parameterType="pd">
		<if test="contentId!=null and contentId!=''">
			UPDATE WEB_CONTENT WC
			SET WC.CONTENT_STATUS = '2'
			WHERE
			WC.ID = #{contentId}
		</if>
	</update>
	<!-- 批量更新内容的状态 -->
	<update id="updateAllContent" parameterType="String">
		UPDATE WEB_CONTENT WC
		SET WC.CONTENT_STATUS = '2'
		where WC.ID in
		<foreach item="item" index="index" collection="array" open="("
			separator="," close=")">
			#{item}
		</foreach>
	</update>

	<!-- 删除栏目的中间表关系 -->
	<delete id="delContentColumconfig">
		DELETE FROM WEB_COLUMCONTENT WHERE CONTENT_ID = #{id}
	</delete>


	<!-- 查询内容类型 -->
	<select id="contentTypeList" parameterType="pd" resultType="pd">
		SELECT
		WCTY.ID AS typeId,
		WCTY.TYPE_NAME AS typeName
		FROM
		WEB_CONTENTTYPE WCTY
		WHERE WCTY.TYPE_STATES='0'
	</select>
	<!-- 查询相关内容 -->
	<select id="contentRelevantList" parameterType="pd" resultType="pd">
		SELECT
		WC.ID AS contentRelevantId,
		WC.CONTENT_TITLE AS contentRelevantTitle
		FROM
		WEB_CONTENT WC
		WHERE
		WC.CONTENT_STATUS = '0'
		<if test="contentId!=null and contentId!=''">
			AND WC.ID != #{contentId}
		</if>
	</select>

	<!-- 修改内容 -->
	<update id="editContent" parameterType="cn.cebest.entity.system.content.Content">
		UPDATE WEB_CONTENT SET
		TYPEID = #{typeId},
		CONTENT_TEMPLATEID = #{contentTemplatetId},
		CONTENT_TITLE = #{contentTitle},
		CONTENT_WBURL = #{contentWbUrl},
		CONTENT_SUMMARY = #{contentSummary},
		CONTENT_KEYWORDS = #{contentKeyWords},
		UPDATE_TIME = #{updateTime},
		SOURCE = #{source},
		DETAIL_TITLE = #{detailTitle},
		PV = #{pv},
		SHARE_COUNT = #{shareCount}
		WHERE
		ID = #{id}
	</update>

	<!-- 先删除相关内容关系 -->
	<delete id="delContentRelevant">
		DELETE FROM WEB_CONTENT_RELEVANT WHERE CONTENT_ID =
		#{id}
	</delete>

	<!-- 修改状态 -->
	<update id="auditContent" parameterType="pd">
		<if test="status!=null and status!=''">
			UPDATE WEB_CONTENT WC
			SET WC.CONTENT_STATUS = #{status}
			<trim prefix="WHERE" prefixOverrides="AND|OR">
				1=1
				<if test="contentId!=null and contentId!=''">
					AND WC.ID = #{contentId}
				</if>
			</trim>
		</if>
	</update>
	<select id="findContentById" parameterType="pd"
		resultMap="detailAndImgRelevantList">
		SELECT
		WC.ID AS id,
		WC.CONTENT_TITLE AS contentTitle,
		WC.CONTENT_WBURL AS contentWbUrl,
		WC.CONTENT_SUMMARY AS contentSummary,
		WC.CONTENT_KEYWORDS AS contentKeyWords,
		WC.CREATED_TIME AS createdTime,
		WC.CONTENT_STATUS AS contentStatus,
		WC.SOURCE AS source,
		WC.DETAIL_TITLE AS detailTitle,
		WC.PV AS pv,
		WC.SHARE_COUNT AS shareCount,
		WC.RELEASE_TIME AS releaseTime,
		WC.CONTENT_TEMPLATEID AS contentTemplatetId,
		WCT.TXT AS contentTxt,
		WCTY.ID AS typeId,
		WCTY.TYPE_NAME AS typeName,
		WI.IMAGE_ID AS imgId,
		WI.IMGURL AS imgurl,
		WC1.ID AS contentId,
		WC1.CONTENT_TITLE AS contentTitle,
		WCCG.ID AS columconfigId
		FROM
		WEB_CONTENT WC
		LEFT JOIN WEB_CONTENTTYPE WCTY ON WC.TYPEID = WCTY.ID
		LEFT JOIN
		WEB_CONTENT_IMAGE WCI ON WCI.CONTENT_ID = WC.ID
		LEFT JOIN WEB_IMAGE WI
		ON WCI.IMAGE_ID = WI.IMAGE_ID
		LEFT JOIN WEB_CONTENT_RELEVANT WCR ON
		WCR.CONTENT_ID = WC.ID
		LEFT JOIN WEB_CONTENT WC1 ON WCR.RELEVANT_ID =
		WC1.ID
		LEFT JOIN WEB_TXT WCT ON WCT.CONTENT_ID=WC.ID
		LEFT JOIN
		WEB_COLUMCONTENT WCCT ON WCCT.CONTENT_ID=WC.ID
		LEFT JOIN
		WEB_COLUMCONFIG WCCG ON WCCT.COLUMCONFIG_ID=WCCG.ID
		WHERE
		WC.ID =#{contentId}
	</select>
	<!-- 根据id查询内容文本 -->
	<select id="findContentTxtById" parameterType="pd" resultType="pd">
		SELECT
		WCTT.CONTENT_ID AS id,
		WCTT.TXT AS contentTxt
		FROM
		WEB_CONTENT_TXT WCTT
		WHERE WCTT.CONTENT_ID=#{id}
	</select>
	<!-- begin=========================================================================================== 
		wzd -->
	<!-- ceshikaishi -->
	<select id="selectTestlistPage" parameterType="page" resultType="string">
		SELECT DISTINCT C.ID
		FROM WEB_CONTENT C
		<if test="pd.colum_id !=null and pd.colum_id !=''">
			LEFT JOIN WEB_COLUMCONTENT CC on CC.CONTENT_ID=C.ID
		</if>
		<where>
			1=1
			<if test="pd.SITEID !=null and pd.SITEID != ''">
				AND C.SITEID=#{pd.SITEID}
			</if>

			<if test="pd.keywords !=null and pd.keywords != ''">
				AND C.CONTENT_TITLE LIKE '%' #{pd.keywords}
				'%'
			</if>
			<if test="pd.colum_id !=null and pd.colum_id !=''">
				AND CC.COLUMCONFIG_ID=#{pd.colum_id}
			</if>
		</where>
		<if test="pd.CREATED_TIME !=null and pd.CREATED_TIME !=''">
			ORDER BY C.CREATED_TIME DESC
		</if>
		<if test="pd.UPDATE_TIME !=null and pd.UPDATE_TIME !=''">
			ORDER BY C.UPDATE_TIME DESC
		</if>
		<if test="pd.TOP_TIME !=null and pd.TOP_TIME !=''">
			ORDER BY C.TOP DESC, C.TOP_TIME DESC
		</if>
		<if test="pd.RECOMMEND_TIME !=null and pd.RECOMMEND_TIME !=''">
			ORDER BY C.RECOMMEND DESC, C.RECOMMEND_TIME DESC
		</if>

	</select>

	<select id="selectByColumIDDlistPage" parameterType="page"
		resultType="string">
		SELECT DISTINCT C.ID
		FROM WEB_CONTENT C
		LEFT JOIN WEB_COLUMCONTENT CC on CC.CONTENT_ID=C.ID
		<where>
			1=1
			<if test="pd.SITEID !=null and pd.SITEID != ''">
				AND C.SITEID=#{pd.SITEID}
			</if>

			<if test="pd.keywords !=null and pd.keywords != ''">
				AND C.CONTENT_TITLE LIKE '%' #{pd.keywords}
				'%'
			</if>
			<if test="pd.colum_id !=null and pd.colum_id !=''">
				AND CC.COLUMCONFIG_ID in
				<foreach collection="pd.list" close=")" item="cid" index="index"
					open="(" separator=",">
					"${cid}"
				</foreach>
			</if>
		</where>
	</select>
	<select id="selectTest" parameterType="pd" resultMap="resultContent">
		SELECT
		C.ID,C.CONTENT_WBURL,C.CONTENT_SUMMARY,C.CONTENT_STATUS,C.CONTENT_KEYWORDS,C.CONTENT_TITLE,C.PV,
		I.IMGURL,CF.COLUM_NAME AS COLUMN_NAME_,CF.ID AS
		CID_,C.RELEASE_TIME,C.TOP,C.RECOMMEND,C.CREATED_TIME
		FROM WEB_CONTENT C
		LEFT JOIN WEB_IMAGE I ON I.IMAGE_ID=C.SURFACE_IMAGEID
		LEFT JOIN
		WEB_COLUMCONTENT CC on CC.CONTENT_ID=C.ID
		LEFT JOIN WEB_COLUMCONFIG CF
		ON CF.ID=CC.COLUMCONFIG_ID
		where C.ID IN
		<foreach collection="ids" close=")" item="id" open="("
			separator=",">
			#{id}
		</foreach>
		<if test="CREATED_TIME !=null and CREATED_TIME !=''">
			ORDER BY C.CREATED_TIME DESC
		</if>
		<if test="UPDATE_TIME !=null and UPDATE_TIME !=''">
			ORDER BY C.UPDATE_TIME DESC
		</if>
		<if test="TOP_TIME !=null and TOP_TIME !=''">
			ORDER BY C.TOP DESC, C.TOP_TIME DESC
		</if>
		<if test="RECOMMEND_TIME !=null and RECOMMEND_TIME !=''">
			ORDER BY C.RECOMMEND DESC, C.RECOMMEND_TIME DESC
		</if>

	</select>
	<!-- ceshijieshu -->
	<select id="selectlistPage" parameterType="page" resultMap="resultContent">
		SELECT
		C.ID,C.CONTENT_WBURL,C.CONTENT_SUMMARY,C.CONTENT_STATUS,C.CONTENT_KEYWORDS,C.CONTENT_TITLE,C.PV,
		I.IMGURL,CF.COLUM_NAME AS COLUMN_NAME_,CF.ID AS
		CID_,C.RELEASE_TIME,C.TOP,C.RECOMMEND,C.RECOMMEND_TIME
		FROM WEB_CONTENT C
		LEFT JOIN
		WEB_IMAGE I ON I.IMAGE_ID=C.SURFACE_IMAGEID
		LEFT JOIN WEB_COLUMCONTENT
		CC on CC.CONTENT_ID=C.ID
		LEFT JOIN WEB_COLUMCONFIG CF ON
		CF.ID=CC.COLUMCONFIG_ID
		<where>
			1=1
			<if test="pd.SITEID !=null and pd.SITEID != ''">
				AND C.SITEID=#{pd.SITEID}
			</if>

			<if test="pd.keywords !=null and pd.keywords != ''">
				AND C.CONTENT_TITLE LIKE '%' #{pd.keywords}
				'%'
			</if>
			<if test="pd.colum_id !=null and pd.colum_id !=''">
				AND CF.ID=#{pd.colum_id}
			</if>
		  AND C.RECOMMEND='1'
		</where>
		ORDER BY C.RECOMMEND_TIME DESC
	</select>

	<!-- 通过id获取数据 -->

	<select id="selectById" resultMap="resultContent">
		SELECT
		C.ID,C.CONTENT_WBURL,C.CONTENT_SUMMARY,C.CONTENT_STATUS,C.CONTENT_KEYWORDS,C.CONTENT_TITLE,C.PV,T.TXT,C.SURFACE_IMAGEID,C.AUTHOR,C.RELEASE_TIME,C.SOURCE,
		C2.ID AS ID_,C2.CONTENT_TITLE AS
		CONTENT_TITLE_,I.TITLE,C.CONTENT_TEMPLATEID,CC.COLUM_NAME AS
		COLUMN_NAME_,CC.ID AS CID_,
		I2.TYPE AS TYPE_,I2.IMAGE_ID AS
		IMAGE_ID_,I2.TITLE AS TITLE_,I2.IMGURL AS IMGURL_,I2.BZ,I2.TOURL AS
		TOURL_,C.FILEDJSON,I2.SUBHEAD,
		V.ID AS VIDEO_ID_,V.VIDEO_TITLE AS VIDEO_TITLE_,V.VIDEO_TYPE AS
		VIDEO_TYPE_,V.VIDEO_URL AS VIDEO_URL_,V.VIDEO_CONTENT AS
		VIDEO_CONTENT_,V.TOURL AS VIDEO_TOURL,
		I.IMGURL AS SURFACE_IMAGEURL,I.IMAGE_ID
		FROM WEB_CONTENT C
		LEFT JOIN WEB_TXT T
		ON C.ID=T.CONTENT_ID
		LEFT JOIN WEB_CONTENT_RELEVANT CR ON
		C.ID=CR.CONTENT_ID
		LEFT JOIN WEB_CONTENT C2 ON C2.ID=CR.RELEVANT_ID
		LEFT JOIN WEB_IMAGE I ON I.IMAGE_ID=C.SURFACE_IMAGEID
		LEFT JOIN
		WEB_COLUMCONTENT CCT ON CCT.CONTENT_ID=C.ID
		LEFT JOIN WEB_COLUMCONFIG
		CC ON CC.ID=CCT.COLUMCONFIG_ID
		LEFT JOIN WEB_IMAGE I2 ON
		I2.MASTER_ID=C.ID
		LEFT JOIN WEB_VIDEO V ON V.MASTER_ID=C.ID
		WHERE C.ID=#{id}
		ORDER BY I2.FORDER ASC
	</select>
	<!-- 批量添加图片 -->
	<insert id="saveImages" parameterType="cn.cebest.entity.system.content.Content">
		INSERT INTO
		WEB_IMAGE(IMAGE_ID,TITLE,IMGURL,TOURL,TYPE,FORDER,BZ,MASTER_ID,SUBHEAD) VALUES
		<foreach collection="timageList" item="image" open=""
			separator="," close="">
			(#{image.imageId},#{image.title},#{image.imgurl},#{image.tourl},6,#{image.forder},#{image.bz},#{image.master_id},#{image.subhead})
		</foreach>
	</insert>

	<!-- 批量添加图片 -->
	<insert id="1saveImages" parameterType="cn.cebest.entity.system.content.Content">
		INSERT INTO
		WEB_IMAGE(IMAGE_ID,TITLE,IMGURL,TOURL,TYPE,FORDER,BZ,MASTER_ID,SUBHEAD) VALUES
		<foreach collection="imageList" item="image" open=""
			separator="," close="">
			(#{image.imageId},#{image.title},#{image.imgurl},#{image.tourl},6,#{image.forder},#{image.bz},#{image.master_id},#{image.subhead})
		</foreach>
	</insert>

	<!-- 添加图片 -->
	<insert id="saveImage" parameterType="cn.cebest.entity.system.Image">
		INSERT INTO WEB_IMAGE(IMAGE_ID,TITLE,IMGURL,TOURL,TYPE,FORDER,BZ,MASTER_ID,SUBHEAD)
		VALUES
		(#{imageId},#{title},#{imgurl},#{tourl},6,#{forder},#{bz},#{master_id},#{subhead})

	</insert>
	<!-- 修改图片 -->
	<update id="updateImageById" parameterType="cn.cebest.entity.system.Image">
		update WEB_IMAGE
		<set>
			TITLE=#{title},
			TOURL=#{tourl},
			SUBHEAD=#{subhead},
			<if test="imgurl !=null and imgurl !=''">IMGURL=#{imgurl},</if>
			<if test="forder !=null and forder !=''">FORDER=#{forder},</if>
			BZ=#{bz}
		</set>
		where IMAGE_ID=#{imageId}
	</update>
	<!-- 批量添加视频 -->
	<insert id="savevideos" parameterType="cn.cebest.entity.system.content.Content">
		INSERT INTO
		WEB_VIDEO(ID,VIDEO_TITLE,VIDEO_CONTENT,TOURL,VIDEO_URL,VIDEO_TYPE,CREATETIME,MASTER_ID)
		VALUES
		<foreach collection="tvideoList" item="video" open=""
			separator="," close="">
			(#{video.id},#{video.video_title},#{video.video_content},#{video.tourl},#{video.video_url},#{video.video_type},#{video.createtime},#{video.master_id})
		</foreach>
	</insert>
	<!-- 批量添加视频 -->
	<insert id="1savevideos" parameterType="cn.cebest.entity.system.content.Content">
		INSERT INTO
		WEB_VIDEO(ID,VIDEO_TITLE,VIDEO_CONTENT,TOURL,VIDEO_URL,VIDEO_TYPE,CREATETIME,MASTER_ID)
		VALUES
		<foreach collection="videoList" item="video" open=""
			separator="," close="">
			(#{video.id},#{video.video_title},#{video.video_content},#{video.tourl},#{video.video_url},#{video.video_type},#{video.createtime},#{video.master_id})
		</foreach>
	</insert>

	<!-- 添加视频 -->
	<insert id="savevideo" parameterType="cn.cebest.entity.system.Video">
		INSERT INTO
		WEB_VIDEO(ID,VIDEO_TITLE,VIDEO_CONTENT,TOURL,VIDEO_URL,VIDEO_TYPE,CREATETIME,MASTER_ID)
		VALUES

		(#{id},#{video_title},#{video_content},#{tourl},#{video_url},#{video_type},#{createtime},#{master_id})

	</insert>
	<!-- 修改视频 -->
	<update id="updateVideoById" parameterType="cn.cebest.entity.system.Video">
		update WEB_VIDEO
		<set>
			VIDEO_TITLE=#{video_title},
			TOURL=#{tourl},
			<if test="video_url !=null and video_url !=''">VIDEO_URL=#{video_url},</if>
			<if test="video_type !=null and video_type !=''">VIDEO_TYPE=#{video_type},</if>
			VIDEO_CONTENT=#{video_content}
		</set>
		where ID=#{id}
	</update>
	<!-- 创建内容文本表数据 -->
	<insert id="saveContentTxt" parameterType="cn.cebest.entity.system.content.Content">
		insert into WEB_TXT (
		CONTENT_ID,TXT
		) values (
		#{id},#{contentTxt}
		)
	</insert>

	<!-- 保存内容栏目 -->
	<insert id="saveContentColumconfig" parameterType="cn.cebest.entity.system.content.Content">
		insert into WEB_COLUMCONTENT (
		CONTENT_ID,COLUMCONFIG_ID
		) values
		<foreach collection="columconfigIds" item="columconfigId"
			close="" open="" separator=",">
			(
			#{id},#{columconfigId}
			)
		</foreach>

	</insert>

	<!-- 保存相关内容关系 -->
	<insert id="saveContentRelevant" parameterType="cn.cebest.entity.system.content.Content">
		<if test="contentRelevantIdList!=null and contentRelevantIdList.length>0">
			INSERT INTO WEB_CONTENT_RELEVANT(CONTENT_ID,RELEVANT_ID) VALUES
			<foreach collection="contentRelevantIdList" item="contentRelevantId"
				open="" separator="," close="">
				(#{id},#{contentRelevantId})
			</foreach>
		</if>
	</insert>

	<!-- 保存内容 -->
	<insert id="saveContent" parameterType="cn.cebest.entity.system.content.Content">
		insert into WEB_CONTENT
		(id,FILEDJSON,SITEID,CONTENT_TEMPLATEID,TYPEID,CONTENT_TITLE,CONTENT_WBURL,CONTENT_SUMMARY,CONTENT_KEYWORDS,CREATED_TIME,UPDATE_TIME,CONTENT_STATUS,SOURCE,DETAIL_TITLE,PV,SHARE_COUNT,RELEASE_TIME,SURFACE_IMAGEID,AUTHOR)
		values
		(#{id},#{filedJson},#{siteId},#{contentTemplateId},#{typeId},#{contentTitle},#{contentWbUrl},#{contentSummary},#{contentKeyWords},#{createdTime},#{updateTime},#{contentStatus},#{source},#{detailTitle},#{pv},#{shareCount},#{releaseTime},#{surface_imageid},#{author})
	</insert>
	<!-- 查询图片路径 -->
	<select id="selectImagePach" resultType="pd">
		SELECT IMAGE_ID,IMGURL
		FROM WEB_IMAGE
		WHERE MASTER_ID IN
		<foreach collection="array" close=")" item="id" open="("
			separator=",">
			#{id}
		</foreach>
	</select>
	<!-- 根据id查询图片路径 -->
	<select id="selectImagePachById" resultType="HashMap">
		SELECT IMGURL,IMAGE_ID
		FROM WEB_IMAGE
		WHERE IMAGE_ID =#{id}
	</select>
	<!-- 根据内容第查询图片路径 -->
	<select id="selectImagePachByContentId" resultType="pd">
		SELECT I.IMGURL,I.IMAGE_ID
		FROM WEB_CONTENT C
		LEFT JOIN WEB_IMAGE I ON
		C.SURFACE_IMAGEID=I.IMAGE_ID
		WHERE C.ID IN
		<foreach collection="array" item="id" open="(" close=")"
			separator=",">
			<if test="id !=null and id != ''">
				#{id}
			</if>
		</foreach>
	</select>
	<!-- 根据内容id批量删除图片信息 -->
	<delete id="deleteImages">
		DELETE FROM WEB_IMAGE
		WHERE MASTER_ID IN
		<foreach collection="array" close=")" item="id" open="("
			separator=",">
			#{id}
		</foreach>
	</delete>


	<!-- 查询视频路径 -->
	<select id="selectVideoPach" resultType="pd">
		SELECT ID,VIDEO_URL
		FROM WEB_VIDEO
		WHERE MASTER_ID IN
		<foreach collection="array" close=")" item="id" open="("
			separator=",">
			#{id}
		</foreach>
	</select>

	<!-- 根据id查询视频路径 -->
	<select id="selectVideoPachById" resultType="HashMap">
		SELECT VIDEO_URL,ID
		FROM WEB_VIDEO
		WHERE ID =#{id}
	</select>

	<!-- 批量删除视频 -->
	<delete id="deleteVideos">
		DELETE FROM WEB_VIDEO
		WHERE MASTER_ID IN
		<foreach collection="array" close=")" item="id" open="("
			separator=",">
			#{id}
		</foreach>
	</delete>

	<select id="selectTXTCount" parameterType="cn.cebest.entity.system.download.FileResources"
		resultType="Integer">
		select count(1)
		from WEB_TXT
		where CONTENT_ID=#{id}
	</select>

	<!-- 批量删除视频 -->
	<delete id="deleteVideosByIds">
		DELETE FROM WEB_VIDEO
		WHERE ID IN
		<foreach collection="array" close=")" item="id" open="("
			separator=",">
			#{id}
		</foreach>
	</delete>

	<!-- 批量删除栏目中间表关系 -->
	<delete id="delContentColumconfigs">
		DELETE FROM WEB_COLUMCONTENT WHERE CONTENT_ID
		IN
		<foreach collection="array" close=")" item="id" open="("
			separator=",">
			#{id}
		</foreach>
	</delete>

	<!-- 修改内容文本 -->
	<update id="editContentTxt" parameterType="cn.cebest.entity.system.content.Content">
		UPDATE WEB_TXT SET
		TXT = #{contentTxt}
		WHERE
		CONTENT_ID = #{id}
	</update>

	<!-- 批量删除中间关系 -->
	<delete id="delContentRelevants">
		DELETE FROM WEB_CONTENT_RELEVANT
		WHERE CONTENT_ID IN
		<foreach collection="array" close=")" item="id" open="("
			separator=",">
			#{id}
		</foreach>
	</delete>
	<!-- 查询全部列表 -->
	<select id="selectAll" parameterType="pd" resultType="pd">
		SELECT
		ID,SITEID,CONTENT_TEMPLATEID,TYPEID,CONTENT_TITLE,CONTENT_WBURL,CONTENT_SUMMARY,CONTENT_KEYWORDS,CREATED_TIME,UPDATE_TIME,CONTENT_STATUS,SOURCE,DETAIL_TITLE,PV,SHARE_COUNT,RELEASE_TIME,SURFACE_IMAGEID
		FROM WEB_CONTENT
		<where>
			SITEID=#{SITEID}
			<if test="ID !=null and ID !=''"> AND ID!=#{ID}</if>
		</where>
	</select>
	<!-- 批量删除内容 -->
	<delete id="deleteAll">
		DELETE FROM WEB_CONTENT
		WHERE ID IN
		<foreach collection="array" close=")" item="id" open="("
			separator=",">
			#{id}
		</foreach>
	</delete>
	<update id="updaeContent" parameterType="cn.cebest.entity.system.content.Content">
		UPDATE WEB_CONTENT
		<set>
		FILEDJSON=#{filedJson},
			SOURCE=#{source},
			AUTHOR=#{author},
			<if test="siteId !=null and siteId !='' ">SITEID=#{siteId},</if>
			<if test="contentTemplateId !=null and contentTemplateId !=''">CONTENT_TEMPLATEID=#{contentTemplateId},</if>
			<if test="contentTitle !=null and contentTitle !=''">CONTENT_TITLE=#{contentTitle},</if>
			<if test="contentWbUrl !=null and contentWbUrl !=''">CONTENT_WBURL=#{contentWbUrl},</if>
			<if test="contentSummary !=null and contentSummary !=''">CONTENT_SUMMARY=#{contentSummary},</if>
			<if test="contentKeyWords !=null and contentKeyWords !='' ">CONTENT_KEYWORDS=#{contentKeyWords},</if>
			<if test="updateTime !=null and updateTime !=''">UPDATE_TIME=#{updateTime},</if>
			<if test="contentStatus !=null and contentStatus !=''">CONTENT_STATUS=#{contentStatus},</if>
			<if test="releaseTime !=null and releaseTime !=''">RELEASE_TIME=#{releaseTime},</if>
			<if test="shareCount !=null and shareCount !=''">SHARE_COUNT=#{shareCount},</if>
			<if test="surface_imageid !=null and surface_imageid !=''">SURFACE_IMAGEID=#{surface_imageid},</if>
		</set>
		WHERE ID=#{id}
	</update>

	<!-- 根据栏目ids查询分类ids -->
	<select id="selectIdsByColumnIds" resultType="String">
		SELECT CONTENT_ID
		FROM WEB_COLUMCONTENT
		WHERE COLUMCONFIG_ID IN
		<foreach collection="array" item="id" close=")" open="("
			separator=",">
			#{id}
		</foreach>
	</select>
	<!-- 查询类型对应的栏目数 -->
	<select id="selectCountByIds" resultType="HashMap">
		SELECT COUNT(*),CONTENT_ID
		FROM WEB_COLUMCONTENT
		WHERE CONTENT_ID IN
		<foreach collection="array" item="id" close=")" open="("
			separator=",">
			#{id}
		</foreach>
		GROUP BY CONTENT_ID
	</select>
	<!-- 根据栏目ids删除和栏目的关联关系 -->
	<delete id="deleteByColumnIds">
		DELETE FROM WEB_COLUMCONTENT
		WHERE COLUMCONFIG_ID IN
		<foreach collection="array" item="id" close=")" open="("
			separator=",">
			#{id}
		</foreach>
	</delete>
	<!-- 查询所有栏目 -->
	<select id="findAllList" parameterType="pd" resultMap="BaseResultMap">
		SELECT
		colum.ID,colum.COLUM_NAME,colum.COLUM_URLPATH,colum.COLUM_DISPLAY,colum.PARENTID,colum.SORT,
		colum.SITEID,colum.COLUM_SUBNAME,colum.COLUM_IMAGE,colum.COLUM_DESC,colum.OUT_URL,colum.CREATETIME,
		temp.ID as TEM_ID,temp.TEM_NAME,temp.TEM_TYPE,temp.TEM_IMAGEPATH
		FROM
		WEB_COLUMCONFIG colum,WEB_TEMPLATE temp
		WHERE colum.SITEID = #{siteid}
		AND colum.COLUM_TEMPLATETID=temp.ID
		ORDER BY colum.SORT
	</select>

	<!-- 查询顶级栏目 -->
	<select id="findTopList1" parameterType="pd" resultMap="BaseResultMap">
		SELECT
		colum.ID,colum.COLUM_NAME,colum.COLUM_URLPATH,colum.COLUM_DISPLAY,colum.PARENTID,colum.SORT,
		colum.SITEID,colum.COLUM_SUBNAME,colum.COLUM_IMAGE,colum.COLUM_DESC,colum.OUT_URL,colum.CREATETIME,
		temp.ID as TEM_ID,temp.TEM_NAME,temp.TEM_TYPE,temp.TEM_IMAGEPATH
		FROM
		WEB_COLUMCONFIG colum,WEB_TEMPLATE temp
		WHERE colum.SITEID = #{siteid}
		AND colum.PARENTID='0' AND colum.COLUM_TEMPLATETID=temp.ID
		ORDER BY
		colum.SORT
	</select>

	<!-- 修改状态与置顶 -->
	<update id="updataRecommendAndTopByIds" parameterType="cn.cebest.entity.system.content.Content">
		UPDATE WEB_CONTENT
		<set>
			UPDATE_TIME=#{updateTime},
			<if test="recommend_time !=null and recommend_time !=''">recommend=#{recommend},</if>
			<if test="recommend_time !=null and recommend_time !=''">recommend_time=#{recommend_time},</if>
			<if test="top_time !=null and top_time !=''">top=#{top},</if>
			<if test="top_time !=null and top_time !=''">top_time=#{top_time}</if>
		</set>
		WHERE ID IN
		<foreach collection="contentRelevantIdList" item="id" close=")"
			open="(" separator=",">
			#{id}
		</foreach>
	</update>

	<select id="selectContentByColumnId" parameterType="pd"
		resultType="cn.cebest.entity.system.content.Content">
		SELECT C.ID,C.CONTENT_TITLE,C.CREATED_TIME
		FROM WEB_CONTENT
		C
		LEFT JOIN WEB_COLUMCONTENT CC ON CC.CONTENT_ID=C.ID
		WHERE
		C.RELEASE_TIME &gt; #{TIME} AND CC.COLUMCONFIG_ID=#{id}
	</select>

	<!-- 根据条件查询文件类型 -->
	<select id="selectAllByAll" parameterType="HashMap" resultType="pd">
		SELECT C.ID,C.CONTENT_WBURL,C.CONTENT_SUMMARY,C.CONTENT_TITLE AS
		TITLE,T.TXT,C.CONTENT_SUMMARY AS DESCRIPTION,
		C.RECOMMEND_TIME,CC.COLUMCONFIG_ID AS COLUMNID
		FROM WEB_CONTENT C
		LEFT
		JOIN WEB_TXT T ON C.ID=T.CONTENT_ID
		INNER JOIN WEB_COLUMCONTENT CC ON
		C.ID=CC.CONTENT_ID
		<where>
			<if test="SITEID !=null and SITEID !=''">and SITEID=#{SITEID}</if>
			<if test="RECOMMEND !=null and RECOMMEND !=''">and RECOMMEND=#{RECOMMEND}</if>
			<if test="RECOMMEND_TIME !=null and RECOMMEND_TIME !=''">and RECOMMEND_TIME &gt; #{RECOMMEND_TIME}</if>
		</where>
	</select>

	<select id="findContentsByColumnId" parameterType="pd"
		resultType="cn.cebest.entity.system.content.Content">
		SELECT C.ID,C.CONTENT_TITLE contentTitle,C.CREATED_TIME
		createdTime,C.SURFACE_IMAGEID,
		M.TITLE AS imgTitle,M.BZ AS imgDesc,M.IMGURL AS imgURL,TX.TXT AS contentTxt
		FROM WEB_CONTENT C
		LEFT JOIN WEB_COLUMCONTENT CC ON
		CC.CONTENT_ID=C.ID
		LEFT JOIN WEB_IMAGE M ON
		C.ID=M.MASTER_ID
		LEFT JOIN WEB_TXT TX ON C.ID=TX.CONTENT_ID
		WHERE CC.COLUMCONFIG_ID=#{id} ORDER BY C.CREATED_TIME DESC
	</select>

	<!-- 查询各个栏目下置顶的内容 -->
	<select id="findTopContentList" resultType="pd">
		SELECT C.ID,C.CONTENT_TITLE,C.CREATED_TIME,CC.COLUMCONFIG_ID,C.TOP_TIME
		FROM WEB_CONTENT
		C
		INNER JOIN WEB_COLUMCONTENT CC ON C.ID=CC.CONTENT_ID
		WHERE C.TOP='1'
	</select>
	<!-- 根据id查询模板路径和栏目 -->
	<select id="selectTemplatePachById" resultMap="resultContent">
		SELECT
		C.ID,T.TEM_FILEPATH AS CONTENT_TEMPLATEID,CC.COLUM_NAME AS
		COLUMN_NAME_,CC.ID AS CID_
		FROM WEB_CONTENT C
		LEFT JOIN WEB_COLUMCONTENT
		CCT ON CCT.CONTENT_ID=C.ID
		LEFT JOIN WEB_COLUMCONFIG CC ON
		CC.ID=CCT.COLUMCONFIG_ID
		LEFT JOIN WEB_TEMPLATE T ON
		T.ID=C.CONTENT_TEMPLATEID
		WHERE C.ID=#{id}
	</select>

	<select id="selectColum" parameterType="pd" resultType="pd">
		SELECT
		C.ID,C.COLUM_NAME
		FROM WEB_COLUMCONFIG C
		WHERE C.SITEID=#{SITEID} AND C.COLUM_TYPE='1'
	</select>
	<!-- 根据内容Id查询详细描述 -->
	<select id="findTxt" resultType="cn.cebest.entity.system.content.Content">
		SELECT
		C.ID,C.CONTENT_WBURL,C.CREATED_TIME,C.CONTENT_SUMMARY,C.CONTENT_TITLE,T.TXT
		FROM WEB_CONTENT C
		LEFT JOIN WEB_TXT T ON C.ID=T.CONTENT_ID
		WHERE
		C.ID=#{contentId}
	</select>
	<!-- 根据栏目id查询全部列表 -->
	<select id="selectlistPageByColumID" parameterType="page"
		resultType="pd">
		SELECT
		C.ID,SITEID,C.CONTENT_TEMPLATEID,C.TYPEID,C.CONTENT_TITLE,C.CONTENT_WBURL,C.CONTENT_SUMMARY,C.CONTENT_KEYWORDS,C.CREATED_TIME,C.UPDATE_TIME,C.CONTENT_STATUS,C.SOURCE,C.DETAIL_TITLE,C.PV,C.SHARE_COUNT,C.RELEASE_TIME,C.SURFACE_IMAGEID,
		I.IMGURL
		FROM WEB_CONTENT C
		JOIN WEB_COLUMCONTENT CC ON C.ID= CC.CONTENT_ID
		JOIN WEB_IMAGE I ON I.IMAGE_ID=C.SURFACE_IMAGEID
		<where>
			SITEID=#{pd.SITEID}
			<if test="pd.ID !=null and pd.ID !=''">ID=#{pd.ID}</if>
			<if test="pd.COLUMCONFIG_ID !=null and pd.COLUMCONFIG_ID !=''">AND COLUMCONFIG_ID=#{pd.COLUMCONFIG_ID}</if>
		</where>
		ORDER BY C.UPDATE_TIME DESC
	</select>

	<!-- 根据栏目id查询全部列表直至查出为止 -->
	<select id="selectByColumIDDlistPage1" parameterType="page"
		resultMap="resultContent">
		SELECT
		C.ID,C.CONTENT_WBURL,C.CONTENT_SUMMARY,C.CONTENT_STATUS,C.CONTENT_KEYWORDS,C.CONTENT_TITLE,C.PV,
		I.IMGURL,CF.COLUM_NAME AS COLUMN_NAME_,CF.ID AS
		CID_,C.RELEASE_TIME,C.TOP,C.RECOMMEND
		FROM WEB_CONTENT C
		LEFT JOIN
		WEB_IMAGE I ON I.IMAGE_ID=C.SURFACE_IMAGEID
		LEFT JOIN WEB_COLUMCONTENT
		CC on CC.CONTENT_ID=C.ID
		LEFT JOIN WEB_COLUMCONFIG CF ON
		CF.ID=CC.COLUMCONFIG_ID
		WHERE
		CF.ID IN

		<foreach collection="pd.list" item="cid" close=")" open="("
			separator=",">
			${cid}
		</foreach>
		ORDER BY C.RELEASE_TIME DESC

	</select>

	<!-- 根据栏目id查找内容 -->
	<select id="findContentInfoBoById" resultType="cn.cebest.entity.bo.ContentInfoBo">
		SELECT
		WCN.ID
		'ID',WCN.CONTENT_TITLE `NAME`,WC.ID 'type',WCN.RECOMMEND_TIME
		'creatTime',wi.IMGURL 'imageUrl'
		FROM WEB_COLUMCONFIG WC
		LEFT JOIN
		WEB_COLUMCONTENT WCC ON WC.ID=WCC.COLUMCONFIG_ID
		LEFT JOIN WEB_CONTENT
		WCN ON WCC.CONTENT_ID=WCN.ID
		LEFT JOIN WEB_IMAGE wi ON
		wi.IMAGE_ID=WCN.SURFACE_IMAGEID
		WHERE (WC.ID=#{id} and
		WCN.RECOMMEND='1')
	</select>

	<select id="findContentsByColumnIdOne" parameterType="pd"
		resultType="cn.cebest.entity.system.content.Content">
		SELECT C.ID,C.CONTENT_TITLE contentTitle,C.CREATED_TIME
		createdTime,C.SURFACE_IMAGEID,M.IMGURL AS SURFACE_IMAGEURL
		FROM
		WEB_CONTENT C
		LEFT JOIN WEB_COLUMCONTENT CC ON CC.CONTENT_ID=C.ID
		LEFT
		JOIN WEB_IMAGE M ON C.SURFACE_IMAGEID=M.IMAGE_ID
		WHERE
		CC.COLUMCONFIG_ID=#{id} ORDER BY C.CREATED_TIME DESC
		limit 1
	</select>

	<select id="selectallcolum_ids" parameterType="page" resultType="HashMap">
		SELECT ID,PARENTID AS PID
		FROM WEB_COLUMCONFIG
		WHERE COLUM_TYPE='1'
	</select>
	<!-- 公司简介wzd -->
	<select id="selectCompanyProfile" parameterType="pd" resultMap="resultContent">
		SELECT
		C.ID,C.CONTENT_WBURL,C.CONTENT_SUMMARY,C.CONTENT_STATUS,C.CONTENT_KEYWORDS,C.CONTENT_TITLE,C.PV,T.TXT,C.SURFACE_IMAGEID,
		C.CONTENT_TEMPLATEID,
		I2.TYPE AS TYPE_,I2.IMAGE_ID AS
		IMAGE_ID_,I2.TITLE AS TITLE_,I2.IMGURL AS IMGURL_,I2.BZ,I2.TOURL AS
		TOURL_,C.FILEDJSON,I2.SUBHEAD,
		V.ID AS VIDEO_ID_,V.VIDEO_TITLE AS VIDEO_TITLE_,V.VIDEO_TYPE AS
		VIDEO_TYPE_,V.VIDEO_URL AS VIDEO_URL_,V.VIDEO_CONTENT AS
		VIDEO_CONTENT_,V.TOURL AS VIDEO_TOURL,
		I.IMGURL AS SURFACE_IMAGEURL,I.IMAGE_ID
		FROM WEB_CONTENT C
		LEFT JOIN WEB_TXT T
		ON C.ID=T.CONTENT_ID
		LEFT JOIN WEB_IMAGE I ON I.IMAGE_ID=C.SURFACE_IMAGEID
		LEFT JOIN
		WEB_COLUMCONTENT CCT ON CCT.CONTENT_ID=C.ID
		LEFT JOIN WEB_IMAGE I2 ON
		I2.MASTER_ID=C.ID
		LEFT JOIN WEB_VIDEO V ON V.MASTER_ID=C.ID
		WHERE 
		C.ID in 
		<foreach collection="ids" close=")" open="(" item="id" separator=",">
			#{id}
		</foreach>
		ORDER BY I2.FORDER ASC
	</select>
	<!-- 根据内容id查询内容，按创建时间排序 -->
	<select id="selectContentListOrderByCreateTime" parameterType="pd" resultMap="resultContent">
		SELECT
		C.ID,C.CONTENT_WBURL,C.CONTENT_SUMMARY,C.CONTENT_STATUS,C.CONTENT_KEYWORDS,C.CONTENT_TITLE,C.PV,T.TXT,C.SURFACE_IMAGEID,
		C.CONTENT_TEMPLATEID,
		C.CREATED_TIME,
		I2.TYPE AS TYPE_,I2.IMAGE_ID AS
		IMAGE_ID_,I2.TITLE AS TITLE_,I2.IMGURL AS IMGURL_,I2.BZ,I2.TOURL AS
		TOURL_,C.FILEDJSON,I2.SUBHEAD,I2.FORDER,
		V.ID AS VIDEO_ID_,V.VIDEO_TITLE AS VIDEO_TITLE_,V.VIDEO_TYPE AS
		VIDEO_TYPE_,V.VIDEO_URL AS VIDEO_URL_,V.VIDEO_CONTENT AS
		VIDEO_CONTENT_,V.TOURL AS VIDEO_TOURL,
		I.IMGURL AS SURFACE_IMAGEURL,I.IMAGE_ID
		FROM WEB_CONTENT C
		LEFT JOIN WEB_TXT T
		ON C.ID=T.CONTENT_ID
		LEFT JOIN WEB_IMAGE I ON I.IMAGE_ID=C.SURFACE_IMAGEID
		LEFT JOIN
		WEB_COLUMCONTENT CCT ON CCT.CONTENT_ID=C.ID
		LEFT JOIN WEB_IMAGE I2 ON
		I2.MASTER_ID=C.ID
		LEFT JOIN WEB_VIDEO V ON V.MASTER_ID=C.ID
		WHERE 
		C.ID in 
		<foreach collection="ids" close=")" open="(" item="id" separator=",">
			#{id}
		</foreach>
		ORDER BY C.CREATED_TIME,I2.FORDER 
	</select>
	<select id="selectUsProfile" parameterType="pd" resultMap="resultContent">
		SELECT
		C.ID,C.CONTENT_WBURL,C.CONTENT_SUMMARY,C.CONTENT_STATUS,C.CONTENT_KEYWORDS,C.CONTENT_TITLE,C.PV,T.TXT,C.SURFACE_IMAGEID,
		C.CONTENT_TEMPLATEID,
		I2.TYPE AS TYPE_,I2.IMAGE_ID AS
		IMAGE_ID_,I2.TITLE AS TITLE_,I2.IMGURL AS IMGURL_,I2.BZ,I2.TOURL AS
		TOURL_,C.FILEDJSON,I2.SUBHEAD,
		V.ID AS VIDEO_ID_,V.VIDEO_TITLE AS VIDEO_TITLE_,V.VIDEO_TYPE AS
		VIDEO_TYPE_,V.VIDEO_URL AS VIDEO_URL_,V.VIDEO_CONTENT AS
		VIDEO_CONTENT_,V.TOURL AS VIDEO_TOURL,
		I.IMGURL AS SURFACE_IMAGEURL,I.IMAGE_ID
		FROM WEB_CONTENT C
		LEFT JOIN WEB_TXT T
		ON C.ID=T.CONTENT_ID
		LEFT JOIN WEB_IMAGE I ON I.IMAGE_ID=C.SURFACE_IMAGEID
		LEFT JOIN
		WEB_COLUMCONTENT CCT ON CCT.CONTENT_ID=C.ID
		LEFT JOIN WEB_IMAGE I2 ON
		I2.MASTER_ID=C.ID
		LEFT JOIN WEB_VIDEO V ON V.MASTER_ID=C.ID
		WHERE CCT.COLUMCONFIG_ID=#{colum_id}
		ORDER BY I2.FORDER ASC
	</select>
	
	<update id="updatePv">
		UPDATE WEB_CONTENT
		SET PV=PV+1
		WHERE ID=#{id}
	</update>
	
	<!-- 通过id获取数据 -->

	<select id="selectContent" parameterType="pd" resultMap="resultContent">
		SELECT
		C.ID,C.CONTENT_WBURL,C.CONTENT_SUMMARY,C.CONTENT_STATUS,C.CONTENT_KEYWORDS,C.CONTENT_TITLE,C.PV,T.TXT,C.SURFACE_IMAGEID,C.AUTHOR,C.RELEASE_TIME,C.SOURCE,
		C2.ID AS ID_,C2.CONTENT_TITLE AS
		CONTENT_TITLE_,I.TITLE,C.CONTENT_TEMPLATEID,CC.COLUM_NAME AS
		COLUMN_NAME_,CC.ID AS CID_,
		I2.TYPE AS TYPE_,I2.IMAGE_ID AS
		IMAGE_ID_,I2.TITLE AS TITLE_,I2.IMGURL AS IMGURL_,I2.BZ,I2.TOURL AS
		TOURL_,C.FILEDJSON,I2.SUBHEAD,
		V.ID AS VIDEO_ID_,V.VIDEO_TITLE AS VIDEO_TITLE_,V.VIDEO_TYPE AS
		VIDEO_TYPE_,V.VIDEO_URL AS VIDEO_URL_,V.VIDEO_CONTENT AS
		VIDEO_CONTENT_,V.TOURL AS VIDEO_TOURL,
		I.IMGURL AS SURFACE_IMAGEURL,I.IMAGE_ID
		FROM WEB_CONTENT C
		LEFT JOIN WEB_TXT T
		ON C.ID=T.CONTENT_ID
		LEFT JOIN WEB_CONTENT_RELEVANT CR ON
		C.ID=CR.CONTENT_ID
		LEFT JOIN WEB_CONTENT C2 ON C2.ID=CR.RELEVANT_ID
		LEFT JOIN WEB_IMAGE I ON I.IMAGE_ID=C.SURFACE_IMAGEID
		LEFT JOIN
		WEB_COLUMCONTENT CCT ON CCT.CONTENT_ID=C.ID
		LEFT JOIN WEB_COLUMCONFIG
		CC ON CC.ID=CCT.COLUMCONFIG_ID
		LEFT JOIN WEB_IMAGE I2 ON
		I2.MASTER_ID=C.ID
		LEFT JOIN WEB_VIDEO V ON V.MASTER_ID=C.ID
		<where>
			1=1
			<if test="SITEID !=null and SITEID != ''">
			AND C.SITEID=#{SITEID}
			</if>
			<if test="currentId !=null and currentId != ''">
			AND CCT.COLUMCONFIG_ID=#{currentId}
			</if>
		</where>
	</select>
	<!-- end -->
</mapper>